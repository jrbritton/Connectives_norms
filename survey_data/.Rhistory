library(lmerTest)
library(reshape2)
library(stats)
library(data.table)
library(dplyr)
library(plyr)
library(nlme)
library(r2glmm)
library(ggpubr)
library(corrplot)
library(PerformanceAnalytics)
library(tidyverse)
library(readr)
library(stringr)
library(magrittr)
library(imputeTS)
library(tibble)
Sys.setlocale("LC_CTYPE",locale="Chinese")
#Import freqTypes file
freqTypes = read_delim("C:/Users/herts/OneDrive/Desktop/RWorkspace/verbSurvey/freqTypesNew.txt",
col_names = T, delim = "\t")
subFreqTypes = subset(freqTypes, select = c(1,3,9))
#Lexical decision data
lexDecData = read_delim("C:/Users/herts/OneDrive/Desktop/RWorkspace/embExp/lexDecData.txt",
col_names = T, delim = "\t")
View(lexDecData)
EmbOneInfo = read_delim("C:/Users/herts/OneDrive/Desktop/RWorkspace/embExp/embOneInfo.txt",
col_names = T, delim = "\t")
#Merge lexical decision data with verb info
lexDecEmb = full_join(lexDecData,EmbOneInfo, by = c("mainStim1" = "filename"), stringsAsFactors = F)
lexDecEmb$syll2 = ifelse(grepl("Mono", lexDecEmb$mainStim1), 1, 0)
lexDecEmb$syll3 = ifelse(grepl("Di", lexDecEmb$mainStim1), 2, 0)
#Sum two columns and create a new one for totals
sum_column = lexDecEmb["syll2"] + lexDecEmb["syll3"]
#Replace NA numeric values with 0 (imputeTS library)
lexDecEmb = na_replace(lexDecEmb, 0)
#Sum together
lexDecEmb["sylls"] = sum_column2
#subset
lexDecEmb = subset(lexDecEmb[,c(1:10,12,13,14,17)])
# Count correct answers (corrAns = keyResp)
lexDecEmb$correct = 0
for (s in 1:nrow(lexDecEmb)) {
lexDecEmb[s,"correct"] = adist(lexDecEmb[s,2],lexDecEmb[s,3])
}
lexDecEmb$correct = gsub(0,1,lexDecEmb$correct)
lexDecEmb$correct = gsub(4,0,lexDecEmb$correct)
lexDecEmb$correct = as.numeric(as.character(lexDecEmb$correct))
# Count errors (corrAns != keyResp)
lexDecEmb$error = 0
for (s in 1:nrow(lexDecEmb)) {
lexDecEmb[s,"error"] = adist(lexDecEmb[s,2],lexDecEmb[s,3])
}
lexDecEmb$error = gsub(0,0,lexDecEmb$error)
lexDecEmb$error = gsub(4,1,lexDecEmb$error)
lexDecEmb$error = as.numeric(as.character(lexDecEmb$error))
View(lexDecEmb)
corrCount = aggregate(lexDecEmb$correct, by=list(variable=lexDecEmb$part), FUN=sum)
colnames(corrCount)[colnames(corrCount)=="x"] = "corr"
colnames(corrCount)[colnames(corrCount)=="variable"] = "part"
trial.num = aggregate(trial~part,data=lexDecEmb,length)
ntrial = trial.num[1,2]
thresh = ntrial*0.25
subjRT = aggregate(RT1~part,data=lexDecEmb,mean)
rtM = mean(subjRT$RT1)
rtSD = sd(subjRT$RT1)
SD2.5 = ((rtSD*2)+(rtSD/2))+rtM
rtDF = data.frame(subset(subjRT,RT1 < SD2.5))
# Exclude correct responses below 108 (75%)
filtCorr = merge(rtDF,corrCount, by = "part")
filtCorr = subset(filtCorr, corr > 107)
filtCorr = subset(filtCorr, select = c(1,3))
corrLexDecEmb = merge(filtCorr,lexDecEmb, by = "part")
#Remove NA rows
lexDecClean = corrLexDecEmb[complete.cases(corrLexDecEmb), ]
lexDecClean = merge(lexDecClean,subFreqTypes, by.x = "word", by.y = "wordSimp")
lexDecCorrelation = subset(lexDecClean[c(6,11:15,19)])
View(lexDecCorrelation)
round(cor(lexDecCorrelation),2)
rcorr(as.matrix(lexDecCorrelation))
corrplot(cor(lexDecCorrelation), method ="circle")
subActStat = subset(lexDecClean, actstat != "Other")
lexDecModelOneFrame = cbind(log10(lexDecClean[,11]), lexDecClean[,-11])
colnames(lexDecModelOneFrame)[1]="tf"
Sys.setlocale("LC_CTYPE",locale="Chinese")
findoutliers = function(a,b){ # a = dataframe, b = threshold in decimal form, i.e., 25% = 0.25
# must have columns Subject, Item, Trial, RT, and Error (0=correct, 1=incorrect, no text)
trial.num = aggregate(Trial~Subject,data=a,length)
ntrial = trial.num[1,2]
thresh = ntrial*b
subjRT = aggregate(RT~Subject,data=a,mean)
rtM = mean(subjRT$RT)
rtSD = sd(subjRT$RT)
SD2.5 = ((rtSD*2)+(rtSD/2))+rtM
rtDF = data.frame(subset(subjRT,RT > SD2.5))
subjERR = aggregate(Error~Subject,data=a,sum)
errDF = data.frame(subset(subjERR,Error > thresh))
itemERR = aggregate(Error~Item,data=a,sum)
itemDF = subset(itemERR, Error > thresh)
print(rtDF)
print(errDF)
print(itemDF)
}
subjRT = aggregate(RT1~part,data=lexDecModelOneFrame,mean)
RTM = mean(lexDecModelOneFrame$RT1)
RTSD = sd(lexDecModelOneFrame$RT1)
SD2.5 = ((RTSD*2)+(RTSD/2))+RTM
lexDecRTOutliers = data.frame(subset(lexDecModelOneFrame,RT1 > SD2.5))
lexDecModelOneFrame = data.frame(subset(lexDecModelOneFrame,RT1 < SD2.5))
lexDecParts = data.frame(unique(lexDecModelOneFrame$part))
colnames(lexDecParts)[1]="part"
lexDecModel1 = lmer(RT1 ~ EmbM + tf + poly + (1|sylls) +(1|part) + (1|word), data = lexDecModelOneFrame)
summary(lexDecModel1)
r2beta(lexDecModel1, partial = TRUE, method = "sgv", data = NULL)
#Plot results
ggplot(lexDecModelOneFrame, aes(x = EmbM, y = RT1)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
#Plot results
ggplot(lexDecModelOneFrame, aes(x = RT1, y = EmbM)) +
geom_point() +
stat_smooth(method = "lm", col = "red")
install.packages("rmarkdown")
install.packages("rmarkdown")
library(tidyverse)
library(postHoc)
library(DescTools)
library(agricolae)
library(RColorBrewer)
library(sjPlot)
library(ordinal)
library(emmeans)
library(openxlsx)
library(rmarkdown)
rstudioapi::writeRStudioPreference("data_viewer_max_columns", 1000L)
---
title: "Chinese 'Even-so' Summary"
library(tidyverse)
library(postHoc)
library(DescTools)
library(agricolae)
library(RColorBrewer)
library(sjPlot)
library(ordinal)
library(emmeans)
setwd("C:\\Users\\herts\\OneDrive\\Desktop\\Manu\\connectives\\Chinese")
chineseData <- read.csv("Results_1234.csv")
View(chineseData)
# Remove NA rows to only look at coherence scores
coherenceScores <- na.omit(chineseData)
View(coherenceScores)
table(coherenceScores$TrialNumber)
# Means by Sentence Condition
chineseCondNorms <- aggregate(Value~Condition, data=coherenceScores,mean);
names(chineseCondNorms) = c("Condition","Mean")
chineseCondSD <- aggregate(Value~Condition, data=coherenceScores,sd);
names(chineseCondSD)= c("Condition","SD")
chineseCondNorms <- merge(chineseCondNorms,chineseCondSD, by = "Condition")
library(tidyverse)
library(lme4)
library(postHoc)
library(DescTools)
library(agricolae)
library(RColorBrewer)
library(sjPlot)
library(ordinal)
library(emmeans)
library(stringr)
library(openxlsx)
setwd("C:\\Users\\herts\\OneDrive\\Desktop\\Manu\\connectives\\survey_data")
rstudioapi::writeRStudioPreference("data_viewer_max_columns", 1000L)
frenchData <- read.csv("french_data.csv")
frenchSentConds <- read.csv("frenchConditions.csv", encoding = "French")
frenchSentConds <- frenchSentConds[,c(-2:-4)]
colnames(frenchData)[colnames(frenchData)=="Time.spent.on.page.3"] = "Time"
table(frenchData$Age)
frenchData1a <- frenchData[c(1:5), c(1,4,5,7,10:89,638)]
frenchData1b <- frenchData[c(6:11), c(1,4,5,7,90:166,638)]
frenchData2a <- frenchData[c(12:16), c(1,4,5,7,167:246,638)]
frenchData2b <- frenchData[c(17:21), c(1,4,5,7,247:323,638)]
frenchData3a <- frenchData[c(22:26), c(1,4,5,7,324:403,638)]
frenchData3b <- frenchData[c(27:32), c(1,4,5,7,404:480,638)]
frenchData4a <- frenchData[c(33:38), c(1,4,5,7,481:560,638)]
frenchData4b <- frenchData[c(39:44), c(1,4,5,7,561:637,638)]
frenchData1a <- reshape2::melt(frenchData1a, id.vars = c(1:4,85))
colnames(frenchData1a)[colnames(frenchData1a)=="variable"] = "Item"
colnames(frenchData1a)[colnames(frenchData1a)=="value"] = "Score"
frenchData1b <- reshape2::melt(frenchData1b, id.vars = c(1:4,82))
colnames(frenchData1b)[colnames(frenchData1b)=="variable"] = "Item"
colnames(frenchData1b)[colnames(frenchData1b)=="value"] = "Score"
frenchData2a <- reshape2::melt(frenchData2a, id.vars = c(1:4,85))
colnames(frenchData2a)[colnames(frenchData2a)=="variable"] = "Item"
colnames(frenchData2a)[colnames(frenchData2a)=="value"] = "Score"
frenchData2b <- reshape2::melt(frenchData2b, id.vars = c(1:4,82))
colnames(frenchData2b)[colnames(frenchData2b)=="variable"] = "Item"
colnames(frenchData2b)[colnames(frenchData2b)=="value"] = "Score"
frenchData3a <- reshape2::melt(frenchData3a, id.vars = c(1:4,85))
colnames(frenchData3a)[colnames(frenchData3a)=="variable"] = "Item"
colnames(frenchData3a)[colnames(frenchData3a)=="value"] = "Score"
frenchData3b <- reshape2::melt(frenchData3b, id.vars = c(1:4,82))
colnames(frenchData3b)[colnames(frenchData3b)=="variable"] = "Item"
colnames(frenchData3b)[colnames(frenchData3b)=="value"] = "Score"
frenchData4a <- reshape2::melt(frenchData4a, id.vars = c(1:4,85))
colnames(frenchData4a)[colnames(frenchData4a)=="variable"] = "Item"
colnames(frenchData4a)[colnames(frenchData4a)=="value"] = "Score"
frenchData4b <- reshape2::melt(frenchData4b, id.vars = c(1:4,82))
colnames(frenchData4b)[colnames(frenchData4b)=="variable"] = "Item"
colnames(frenchData4b)[colnames(frenchData4b)=="value"] = "Score"
allDataFre <- rbind(frenchData1a,frenchData1b,frenchData2a,frenchData2b,
frenchData3a,frenchData3b,frenchData4a,frenchData4b)
#View(allDataFre)
allDataFre <- merge(allDataFre,frenchSentConds, by.x = "Item", by.y = "SOS_ID")
